<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<title>dynamically shared objects</title>
	<meta name="description" content="">
	<meta name="author" content="adam pridgen">
	<link rel="shortcut icon" type="image/png" href="/theme/images/icons/favicon.png">
	<link rel="shortcut icon" type="image/x-icon" href="/images/favicon.ico">



	<!-- HTML5 shim, for IE6-8 support of HTML elements -->
	<!--[if lt IE 9]>
		<script src="/theme/html5.js"></script>
	<![endif]-->

	<!-- Styles -->
	<link href="/theme/bootstrap.min.css" rel="stylesheet">
	<link href="/theme/local.css" rel="stylesheet">
	<link href="/theme/pygments.css" rel="stylesheet">

    <!-- Feeds -->
</head>
<body>
	<div class="topbar">
	  <div class="topbar-inner">
		<div class="container-fluid">
		  <a class="brand" href="/">dynamically shared objects</a>
			<ul class="nav">
						<li><a href="/pages/about-me.html">About</a></li>
					<li class="active"><a href="/category/reverse-engineering">Reverse Engineering</a></li>
			</ul>
			<p class="pull-right"><a href="/archives.html">[archives]</a> <a href="/tags.html">[tags]</a> <a href="/search.html">[search]</a> </p>
		</div>
	  </div>
	</div>

	<div class="container-fluid">
	  <div class="sidebar">
		<div class="well">
                        <div class="social">
			<h3>Links</h3>
			<ul style="list-style: none;">
				<li><a href="https://github.com/deeso">Github</a></li>
				<li><a href="https://bitbucket.org/deeso">Bitbucket</a></li>
				<li><a href="https://twitter.com/apridgen">Twitter</a></li>
				<li><a href="https://linkedin.com/in/memoization">Linkedin</a></li>
			</ul>
                        </div> 
                        <div class="social">
			<h3>Feeds</h3>
			<ul style="list-style: none;">
				<li><a href="feeds/all.atom.xml">All posts</a></li>
			</ul>
                        </div>
		</div>
	  </div>
	  <div class="content">
	<div class='article'>
		<div class="page-header"><h1>Introduction to Radare Java Reverse Engineering</h1></div>
		<div class="well small"><a class="more" href="/posts/2014/04/radare-java-intro/">Wed 09 April 2014</a>
by <a class="url fn" href="/author/adam-pridgen.html">Adam Pridgen </a>
 in <a href="/category/reverse-engineering">Reverse Engineering</a>
tags: <a href="/tag/radare/">radare</a> <a href="/tag/hacking/">hacking</a> <a href="/tag/reverse-engineering/">reverse engineering</a> <a href="/tag/java/">java</a> <a href="/tag/coding/">coding</a> <a href="/tag/frameworks/">frameworks</a> </div>
		<div><h2>0. Introduction</h2>
<p>Radare is a reverse engineering framework that was built to support a command line hacker's needs. The frame work supports a number of different architectures and binary formats, which range from esoteric languages like BrainFuck to more common binary formats like MS-DOS Portable Executables (PE) or the Executable Linker Format (ELF).  In the past Radare has had limited support for Java reverse engineering, but this support provided only a minimal amount of information like disassembly, symbols, and import information.  The Java support has recently been updated and set of new features were added to Radare to help facilitate the analysis of Java class and Java Archive (JAR) file formats.</p>
<p>The focus of this post is to introduce some of these new features in addition to providing a basic walk-through for using Radare as a reverse engineering tool againt a ZIP archive and Java class files.  Typically, Java can be decompiled using tools like JD-GUI, JAD, JODE, CFR, etc., but these tools run into limitations when they are used against malicious or intentionally obfuscated code.  The purpose of these Radare extensions is to give malware analysts and reverse engineers a set of tools that can be used  to analyze Java based malware.  </p>
<p>In general, Java malware is fairly easy to identify and classify based on the code, import libraries, and the methods used by those imports, but when an analyst is asked to enumerate the functionality or explain what it does, they could be left in the dark.  Before the commencement of this project, there were a limited set of tools and those tools were typically written in Java.  Its not to say tools written in Java are less effective, but rather these tools take advantage of implicit assumptions that are implicit if the code comes from a considerate compiler and is not obfuscated.</p>
<p>For example, I found that that the <strong>SYNTHETIC</strong> flags or attributes in methods, fields, or classes code or other artifacts could be used to hide artifacts from an analyst.  This particular case arises because the <strong>SYNTHETIC</strong> attribute is used to indicate compiler generated code, and a decompiler or other analysis tool might assume this is an artifact is only for a compiler.  In the case of JD-GUI, if a method is marked with the <strong>SYNTHETIC</strong> flag, the code will not be decompiled and displayed to the user.  This means that a smart malware author could conceal functionality in plain sight.  CFR actually decompiled this and presented it to the user.  This was verified by setting the <strong>SYNTHETIC</strong> flags on a method in a Java class file, and then then the method was decompiled with both JD-GUI and CFR.</p>
<p>The remainder of this post will provide a basic introduction to Radare, and the coming days there will be some additional posts about the Java extensions and how they can be used to help analyze Java malware.  The first two sections will talk about setting up the environment.  The remainder of the post will focus on how to enumerate, analyse, and extract files from a ZIP archives.  The last section will discuss how to move data from files to archives and archive files to disk with the yank command.</p>
<h2>1. Getting started</h2>
<p>Radare can be compiled from source, or if you want to use a clean environment, you can set up a docker image.  If you get radare from source, it can be retrieved from github.  If you want to go the docker route, simply install Docker and perform the following commands:</p>
<p>Initialize the Docker and run r2:</p>
<div class="highlight"><pre><span class="err">$</span> <span class="n">cat</span> <span class="n">radare2</span><span class="p">.</span><span class="n">docker</span> <span class="o">&gt;</span> <span class="n">Dockerfile</span>
<span class="err">$</span> <span class="n">docker</span> <span class="n">build</span> <span class="o">-</span><span class="n">t</span> <span class="n">r2</span><span class="o">/</span><span class="n">radare2</span> <span class="p">.</span>
<span class="err">$</span> <span class="n">docker</span> <span class="n">run</span> <span class="o">-</span><span class="n">t</span>  <span class="o">-</span><span class="n">i</span> <span class="n">r2</span><span class="o">/</span><span class="n">radare2</span>  <span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">bash</span>
</pre></div>


<p>radare2.docker:</p>
<div class="highlight"><pre><span class="cp"># using phusion/baseimage as base image. </span>
<span class="n">FROM</span> <span class="n">phusion</span><span class="o">/</span><span class="n">baseimage</span><span class="o">:</span><span class="mf">0.9.9</span>

<span class="cp"># Set correct environment variables.</span>
<span class="n">ENV</span> <span class="n">HOME</span> <span class="o">/</span><span class="n">root</span>

<span class="cp"># Regenerate SSH host keys. baseimage-docker does not contain any</span>
<span class="n">RUN</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">my_init</span><span class="p">.</span><span class="n">d</span><span class="o">/</span><span class="mo">00</span><span class="n">_regen_ssh_host_keys</span><span class="p">.</span><span class="n">sh</span>

<span class="cp"># Use baseimage-docker&#39;s init system.</span>
<span class="n">CMD</span> <span class="p">[</span><span class="s">&quot;/sbin/my_init&quot;</span><span class="p">]</span>

<span class="cp"># create code directory</span>
<span class="n">RUN</span> <span class="n">mkdir</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">code</span><span class="o">/</span>
<span class="cp"># install packages required to compile vala and radare2</span>
<span class="n">RUN</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">update</span>
<span class="n">RUN</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="o">-</span><span class="n">y</span> <span class="n">software</span><span class="o">-</span><span class="n">properties</span><span class="o">-</span><span class="n">common</span> <span class="n">python</span><span class="o">-</span><span class="n">all</span><span class="o">-</span><span class="n">dev</span> <span class="n">wget</span>
<span class="n">RUN</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="o">-</span><span class="n">y</span> <span class="n">swig</span> <span class="n">flex</span> <span class="n">bison</span> <span class="n">git</span> <span class="n">gcc</span> <span class="n">g</span><span class="o">++</span> <span class="n">make</span> <span class="n">pkg</span><span class="o">-</span><span class="n">config</span> <span class="n">glib</span><span class="o">-</span><span class="mf">2.0</span>
<span class="n">RUN</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="o">-</span><span class="n">y</span> <span class="n">python</span><span class="o">-</span><span class="n">gobject</span><span class="o">-</span><span class="n">dev</span>

<span class="cp"># compile vala</span>
<span class="n">RUN</span> <span class="n">cd</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">code</span><span class="p">;</span> <span class="n">wget</span> <span class="n">http</span><span class="o">:</span><span class="c1">//download.gnome.org/sources/vala/0.24/vala-0.24.0.tar.xz; tar -Jxf vala-0.24.0.tar.xz</span>
<span class="n">RUN</span> <span class="n">cd</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">code</span><span class="o">/</span><span class="n">vala</span><span class="o">-</span><span class="mf">0.24.0</span><span class="p">;</span> <span class="p">.</span><span class="o">/</span><span class="n">configure</span> <span class="o">--</span><span class="n">prefix</span><span class="o">=/</span><span class="n">usr</span> <span class="p">;</span> <span class="n">make</span> <span class="o">&amp;&amp;</span> <span class="n">make</span> <span class="n">install</span>
<span class="cp"># compile radare</span>
<span class="n">RUN</span> <span class="n">cd</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">code</span><span class="p">;</span> <span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="o">:</span><span class="c1">//github.com/radare/radare2.git; cd radare2; ./sys/all.sh</span>

<span class="cp"># Clean up APT when done.</span>
<span class="n">RUN</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">clean</span> <span class="o">&amp;&amp;</span> <span class="n">rm</span> <span class="o">-</span><span class="n">rf</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">apt</span><span class="o">/</span><span class="n">lists</span><span class="o">/*</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/*</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">tmp</span><span class="o">/*</span>
</pre></div>


<h2>2. Creating the example file</h2>
<p>Lets start by writing a new file to disk using a hexlified string.  The below example will open an empty file and then write all the bytes to example.zip.</p>
<div class="highlight"><pre><span class="err">$</span> <span class="nb">zip</span> <span class="nx">example.zip</span> <span class="nx">anypkg</span><span class="p">/</span><span class="nx">Attacker.class</span> <span class="nx">anypkg</span><span class="p">/</span><span class="nx">BlyahaMuha.class</span>
<span class="err">$</span> <span class="nx">rax2</span> <span class="na">-S</span> <span class="o">&lt;</span> <span class="nx">example.zip</span> <span class="o">&gt;</span> <span class="kd">data</span><span class="bp">.</span><span class="nx">hex</span>
<span class="err">$</span> <span class="nx">cat</span> <span class="kd">data</span><span class="bp">.</span><span class="nx">hex</span>
<span class="mi">504</span><span class="nx">b0304140000000800ce9a5242390493e76a05000</span><span class="o">&lt;</span><span class="nx">truncated</span><span class="o">&gt;</span>
</pre></div>


<p>Open an empty archive and write a hexlified string with <strong>wx</strong>:</p>
<div class="highlight"><pre><span class="err">$</span> <span class="n">r2</span> <span class="o">-</span><span class="n">w</span> <span class="n">example</span><span class="p">.</span><span class="n">zip</span>
<span class="p">[</span><span class="mh">0x00000000</span><span class="p">]</span><span class="o">&gt;</span> <span class="n">wx</span> <span class="mi">504</span><span class="n">b0304140000000800dd7c7f44195f7fd7f2020000ef0400003a001c0072657365617263685f646174612f6578706572696d656e742f6465636f6d70696c65722f64756d7065645f6a61725f6465632f632e636c617373555409000361d2395392c43e5375780b000104e803000004e8030000ad52cd4f135110ff3dbadb6dcb0205f9d002f2a5d8166c0501452ac216488ca02628849664b32c0b2ec2962c8b112f26c69b9ebce195c3269ef8484a2209dcfda35ce76df988c2d1cdbe79f37e33f3667ef3e6d7ef9fc7007a311142b38476091d126e49b82da1338232544610401517351188fc28221a41906b4154cbb88e6b5c34c868419d8c56d4cb68431d43209e9861e88c4fae68efb4f4aa662da7a71ddbb4968712972186faab1cf30a37e4952b23446ea014c18c6999ce30297a8abb3108d9c2a2c15035695ac6f3cdb505c37ea52dac1212992e6cdaba3161f28328dab3d57906b6c0202f1a3ac5289b4b4b864d371996ee5f115a361c65cb313618a21725bc58583174e72fa854155da653c51b9b567acddcd0d3cae8f4f840df987fb77dd9306e9d1ac2b96753fda9fed4e038dd4004584e461c8930042425c465a49026d4a4f5348c6edc95d0cbd07291bec472a260af69cef87bdd5877cc8245de1f186aaeea5d28a3affa5d93f1000f19ca9d42f68d668fdab6b645fd8b27f259fee603fc694badce266638f248c6309e50874ccb316c4a511bbfe271b8e76319f7d1c7298c32544c3b9afe764a5bf71f4202f12ccb676950049a31d00a73bea4c57810ed02181f2d92313a35d3ce6817938790f64861682419f441c90fae3d754d526a8ed61c2138770839b90fa588701115bbffc44528eee679dc171a6c5e4a6a1f5d992304e68e20527c245944f92142fbb8b78ddac66dc82e8493800bf1443840d72ec53451f6387aa8e45674d05e769e434025b2a4a711f4c8542621403c24f48c90963ddd3dcedfb7f852218110facfb83385cae4e57eac6151cf45f8008a0b472d6270ee580d0ca93961075373b1f9be5868fd07f9f5a0f405fcbe01edb4eed0ea8ebe74511bed745115ad76118966884454fff4edf5673035f71da179d5f58ed45c6cc73ba006e4d443648a185167d559d7fb5aea3a67b307d9a3a6339f0a952f9e11f0882ea10146f898c79f8c26c73fd04fd6360e04cf014284ff84f8a9a40b84a0aa8b521ac8dee44fd98d3f504b01021e03140000000800dd7c7f44195f7fd7f2020000ef0400003a0018000000000000000000a4810000000072657365617263685f646174612f6578706572696d656e742f6465636f6d70696c65722f64756d7065645f6a61725f6465632f632e636c617373555405000361d2395375780b000104e803000004e8030000504b0506000000000100010080000000660300000000</span>
<span class="p">[</span><span class="mh">0x00000000</span><span class="p">]</span><span class="o">&gt;</span> <span class="n">q</span>
</pre></div>


<h2>3. Enumerating Files in the Zip</h2>
<p>List the files in the example by opening the archive with the "<strong>zip://</strong>" uri.</p>
<div class="highlight"><pre><span class="err">$</span> <span class="n">r2</span> <span class="n">zip</span><span class="o">:</span><span class="c1">//example.zip</span>
<span class="mi">0</span> <span class="n">anypkg</span><span class="o">/</span><span class="n">Attacker</span><span class="p">.</span><span class="n">class</span>
<span class="mi">1</span> <span class="n">anypkg</span><span class="o">/</span><span class="n">BlyahaMuha</span><span class="p">.</span><span class="n">class</span>
</pre></div>


<p>Opening by index:</p>
<div class="highlight"><pre><span class="err">$</span> <span class="n">r2</span> <span class="n">zip</span><span class="o">:</span><span class="c1">//example.zip::0</span>
<span class="p">[</span><span class="mh">0x00000690</span><span class="p">]</span><span class="o">&gt;</span>
</pre></div>


<p>Opening by path:</p>
<div class="highlight"><pre><span class="err">$</span> <span class="n">r2</span> <span class="n">zip</span><span class="o">:</span><span class="c1">//example.zip//anypkg/Attacker.class</span>
<span class="p">[</span><span class="mh">0x00000690</span><span class="p">]</span><span class="o">&gt;</span>
</pre></div>


<h2>4. Enumerating Java Class File Information</h2>
<p>Radare provides some really good informational commands that are typically used for the basic file information, if the developer implements them.  For Java, a large number of the basic information is implemented.</p>
<ol>
<li><strong>if</strong> or <strong>ijf</strong>: list the the information related to the class file in standard or JSON output</li>
<li><strong>ii</strong> or <strong>iji</strong>: list the imported classes methods and fields used in the class file</li>
<li><strong>il</strong> or <strong>ijl</strong>: list all of classes/libraries used by the class file</li>
<li><strong>ic</strong> or <strong>ijc</strong>: list the class hierarchy for the current class file</li>
<li><strong>iz</strong> or <strong>ijZ</strong>: list the all the strings in the class file</li>
<li><strong>iS</strong> or <strong>ijS</strong>: show where where the CP array, fields array, methods array, and attributes array begins.</li>
</ol>
<p>Radare Java analysis contains several different features that will be covered in the future.  In general, the extension commands can be run with "<strong>java &lt;<em>command</em>&gt;</strong>" like "<strong>java resolve_cp d</strong>".  The "<strong>resolve_cp</strong>" command is used to resolve or identify Constant Pool objects in the class file by their index.  Below the <strong>java resolve_cp d</strong> will dump all the CP objects in the class file.</p>
<div class="highlight"><pre><span class="cp">[</span><span class="mh">0x00000690</span><span class="cp">]</span>&gt; java resolve_cp d
MethodRef ConstantPool Type (1)         Offset: 0x0000000a      Class Index = 39
        Name and type Index = 87
MethodRef ConstantPool Type (2)         Offset: 0x0000000f      Class Index = 39
        Name and type Index = 88
String ConstantPool Type (3)    Offset: 0x00000014      String Index = 89
MethodRef ConstantPool Type (4)         Offset: 0x00000017      Class Index = 38
        Name and type Index = 90
FieldRef ConstantPool Type (5)  Offset: 0x0000001c      Class Index = 38
        Name and type Index = 91
ClassRef ConstantPool Type (6)  Offset: 0x00000021      Name Index = 92
MethodRef ConstantPool Type (7)         Offset: 0x00000024      Class Index = 6
<span class="nt">&lt;snip&gt;</span>
</pre></div>


<p>For more information on the extensions, checkout "java help".  Note some of the commands will not work if analysis is not performed.  Before discussing the code analysis, lets briefly cover some additional information that is provided when Radare reports the class files's sections and symbols.  JVM class files are very good about separating code and data while including alot of meta-information that can be used for reversing or modifying the class file without lifting it back to source (e.g. decompiling).  In the symbols list (e.g. is), the descriptor notes whether a field or method are <strong>FUNC</strong>, <strong>FUNC_META</strong>, <strong>FIELD</strong>, or <strong>FIELD_META</strong>.  In these cases, the <strong>*_META</strong> points to the start of the meta-information, and <strong>FUNC</strong> will point to the actual code.  In the case of <strong>FIELD</strong> and <strong>FIELD_META</strong>, they will point to the same location because the <strong>FIELD</strong> is used to more or less to hold values, which only exist if the value is a constant.</p>
<p>Below shows the output of the <strong>is</strong>, which will output the symbol information for the class file.</p>
<div class="highlight"><pre><span class="p">[</span><span class="mh">0x00000690</span><span class="p">]</span><span class="o">&gt;</span> <span class="n">is</span>
<span class="p">[</span><span class="n">Symbols</span><span class="p">]</span>
<span class="n">addr</span><span class="o">=</span><span class="mh">0x00000690</span> <span class="n">off</span><span class="o">=</span><span class="mh">0x00000690</span> <span class="n">ord</span><span class="o">=</span><span class="mo">000</span> <span class="n">fwd</span><span class="o">=</span><span class="n">NONE</span> <span class="n">sz</span><span class="o">=</span><span class="mi">5</span> <span class="n">bind</span><span class="o">=</span> <span class="n">type</span><span class="o">=</span><span class="n">FUNC</span> <span class="n">name</span><span class="o">=</span><span class="n">_init_</span>
<span class="n">addr</span><span class="o">=</span><span class="mh">0x0000067a</span> <span class="n">off</span><span class="o">=</span><span class="mh">0x0000067a</span> <span class="n">ord</span><span class="o">=</span><span class="mo">000</span> <span class="n">fwd</span><span class="o">=</span><span class="n">NONE</span> <span class="n">sz</span><span class="o">=</span><span class="mi">61</span> <span class="n">bind</span><span class="o">=</span><span class="n">java</span><span class="o">/</span><span class="n">applet</span><span class="o">/</span><span class="n">Applet</span> <span class="n">type</span><span class="o">=</span><span class="n">FUNC_META</span> <span class="n">name</span><span class="o">=</span><span class="n">mmeta__init_</span>
<span class="n">addr</span><span class="o">=</span><span class="mh">0x000006cd</span> <span class="n">off</span><span class="o">=</span><span class="mh">0x000006cd</span> <span class="n">ord</span><span class="o">=</span><span class="mo">001</span> <span class="n">fwd</span><span class="o">=</span><span class="n">NONE</span> <span class="n">sz</span><span class="o">=</span><span class="mi">122</span> <span class="n">bind</span><span class="o">=</span> <span class="n">type</span><span class="o">=</span><span class="n">FUNC</span> <span class="n">name</span><span class="o">=</span><span class="n">init</span>
<span class="n">addr</span><span class="o">=</span><span class="mh">0x000006b7</span> <span class="n">off</span><span class="o">=</span><span class="mh">0x000006b7</span> <span class="n">ord</span><span class="o">=</span><span class="mo">001</span> <span class="n">fwd</span><span class="o">=</span><span class="n">NONE</span> <span class="n">sz</span><span class="o">=</span><span class="mi">361</span> <span class="n">bind</span><span class="o">=</span><span class="n">java</span><span class="o">/</span><span class="n">applet</span><span class="o">/</span><span class="n">Applet</span> <span class="n">type</span><span class="o">=</span><span class="n">FUNC_META</span> <span class="n">name</span><span class="o">=</span><span class="n">mmeta_init</span>
<span class="n">addr</span><span class="o">=</span><span class="mh">0x00000836</span> <span class="n">off</span><span class="o">=</span><span class="mh">0x00000836</span> <span class="n">ord</span><span class="o">=</span><span class="mo">002</span> <span class="n">fwd</span><span class="o">=</span><span class="n">NONE</span> <span class="n">sz</span><span class="o">=</span><span class="mi">105</span> <span class="n">bind</span><span class="o">=</span><span class="n">LOCAL</span> <span class="n">type</span><span class="o">=</span><span class="n">FUNC</span> <span class="n">name</span><span class="o">=</span><span class="n">createMe</span>
<span class="n">addr</span><span class="o">=</span><span class="mh">0x00000820</span> <span class="n">off</span><span class="o">=</span><span class="mh">0x00000820</span> <span class="n">ord</span><span class="o">=</span><span class="mo">002</span> <span class="n">fwd</span><span class="o">=</span><span class="n">NONE</span> <span class="n">sz</span><span class="o">=</span><span class="mi">295</span> <span class="n">bind</span><span class="o">=</span><span class="n">anypkg</span><span class="o">/</span><span class="n">Attacker</span> <span class="n">type</span><span class="o">=</span><span class="n">FUNC_META</span> <span class="n">name</span><span class="o">=</span><span class="n">mmeta_createMe</span>
<span class="n">addr</span><span class="o">=</span><span class="mh">0x0000095d</span> <span class="n">off</span><span class="o">=</span><span class="mh">0x0000095d</span> <span class="n">ord</span><span class="o">=</span><span class="mo">003</span> <span class="n">fwd</span><span class="o">=</span><span class="n">NONE</span> <span class="n">sz</span><span class="o">=</span><span class="mi">4</span> <span class="n">bind</span><span class="o">=</span> <span class="n">type</span><span class="o">=</span><span class="n">FUNC</span> <span class="n">name</span><span class="o">=</span><span class="n">getPath</span>
<span class="n">addr</span><span class="o">=</span><span class="mh">0x00000947</span> <span class="n">off</span><span class="o">=</span><span class="mh">0x00000947</span> <span class="n">ord</span><span class="o">=</span><span class="mo">003</span> <span class="n">fwd</span><span class="o">=</span><span class="n">NONE</span> <span class="n">sz</span><span class="o">=</span><span class="mi">42</span> <span class="n">bind</span><span class="o">=</span><span class="n">anypkg</span><span class="o">/</span><span class="n">Attacker</span> <span class="n">type</span><span class="o">=</span><span class="n">FUNC_META</span> <span class="n">name</span><span class="o">=</span><span class="n">mmeta_getPath</span>
<span class="n">addr</span><span class="o">=</span><span class="mh">0x00000987</span> <span class="n">off</span><span class="o">=</span><span class="mh">0x00000987</span> <span class="n">ord</span><span class="o">=</span><span class="mo">004</span> <span class="n">fwd</span><span class="o">=</span><span class="n">NONE</span> <span class="n">sz</span><span class="o">=</span><span class="mi">1</span> <span class="n">bind</span><span class="o">=</span> <span class="n">type</span><span class="o">=</span><span class="n">FUNC</span> <span class="n">name</span><span class="o">=</span><span class="n">main</span>
<span class="n">addr</span><span class="o">=</span><span class="mh">0x00000971</span> <span class="n">off</span><span class="o">=</span><span class="mh">0x00000971</span> <span class="n">ord</span><span class="o">=</span><span class="mo">004</span> <span class="n">fwd</span><span class="o">=</span><span class="n">NONE</span> <span class="n">sz</span><span class="o">=</span><span class="mi">57</span> <span class="n">bind</span><span class="o">=</span><span class="n">anypkg</span><span class="o">/</span><span class="n">Attacker</span> <span class="n">type</span><span class="o">=</span><span class="n">FUNC_META</span> <span class="n">name</span><span class="o">=</span><span class="n">mmeta_main</span>
<span class="n">addr</span><span class="o">=</span><span class="mh">0x000009c0</span> <span class="n">off</span><span class="o">=</span><span class="mh">0x000009c0</span> <span class="n">ord</span><span class="o">=</span><span class="mo">005</span> <span class="n">fwd</span><span class="o">=</span><span class="n">NONE</span> <span class="n">sz</span><span class="o">=</span><span class="mi">6</span> <span class="n">bind</span><span class="o">=</span> <span class="n">type</span><span class="o">=</span><span class="n">FUNC</span> <span class="n">name</span><span class="o">=</span><span class="n">_clinit_</span>
<span class="n">addr</span><span class="o">=</span><span class="mh">0x000009aa</span> <span class="n">off</span><span class="o">=</span><span class="mh">0x000009aa</span> <span class="n">ord</span><span class="o">=</span><span class="mo">005</span> <span class="n">fwd</span><span class="o">=</span><span class="n">NONE</span> <span class="n">sz</span><span class="o">=</span><span class="mi">44</span> <span class="n">bind</span><span class="o">=</span><span class="n">anypkg</span><span class="o">/</span><span class="n">Attacker</span> <span class="n">type</span><span class="o">=</span><span class="n">FUNC_META</span> <span class="n">name</span><span class="o">=</span><span class="n">mmeta__clinit_</span>
<span class="n">addr</span><span class="o">=</span><span class="mh">0x00000670</span> <span class="n">off</span><span class="o">=</span><span class="mh">0x00000670</span> <span class="n">ord</span><span class="o">=</span><span class="mo">000</span> <span class="n">fwd</span><span class="o">=</span><span class="n">NONE</span> <span class="n">sz</span><span class="o">=</span><span class="mi">8</span> <span class="n">bind</span><span class="o">=</span> <span class="n">type</span><span class="o">=</span><span class="n">FIELD</span> <span class="n">name</span><span class="o">=</span><span class="n">_lastParam</span>
<span class="n">addr</span><span class="o">=</span><span class="mh">0x00000670</span> <span class="n">off</span><span class="o">=</span><span class="mh">0x00000670</span> <span class="n">ord</span><span class="o">=</span><span class="mo">000</span> <span class="n">fwd</span><span class="o">=</span><span class="n">NONE</span> <span class="n">sz</span><span class="o">=</span><span class="mi">8</span> <span class="n">bind</span><span class="o">=</span><span class="n">anypkg</span><span class="o">/</span><span class="n">Attacker</span> <span class="n">type</span><span class="o">=</span><span class="n">FIELD_META</span> <span class="n">name</span><span class="o">=</span><span class="n">mmeta__lastParam</span>

<span class="mi">14</span> <span class="n">symbols</span>
</pre></div>


<p>In the case of the sections, the sections of the file are broken down in the following manner:</p>
<ol>
<li><strong>constant_pool:</strong> Constant Pool Section (see JVM/class file spec.)</li>
<li><strong>fields:</strong> Start of the Actual Fields Array, (see JVM/class file spec.)</li>
<li><strong>attrs.&lt;<em>field_name</em>&gt;:</strong> Start of the attributes array for the given field, (see JVM/class file spec.)</li>
<li><strong>methods:</strong> Start of the Actual Methods Array, (see JVM/class file spec.)</li>
<li><strong>attrs.&lt;<em>method_name</em>&gt;:</strong> Start of the attributes array for the given method, (see JVM/class file spec.)</li>
</ol>
<p>Below are the sections reported by the <strong>iS</strong> command.  Note that the <strong>attr._lastParam</strong> in the <strong>iS</strong> does not have a corresponding section, because there is no attribute array for this field.</p>
<div class="highlight"><pre><span class="p">[</span><span class="mh">0x00000690</span><span class="p">]</span><span class="o">&gt;</span> <span class="n">iS</span>
<span class="p">[</span><span class="n">Sections</span><span class="p">]</span>
<span class="n">idx</span><span class="o">=</span><span class="mo">00</span> <span class="n">addr</span><span class="o">=</span><span class="mh">0x0000066c</span> <span class="n">off</span><span class="o">=</span><span class="mh">0x0000066c</span> <span class="n">sz</span><span class="o">=</span><span class="mi">1630</span> <span class="n">vsz</span><span class="o">=</span><span class="mi">0</span> <span class="n">perm</span><span class="o">=----</span> <span class="n">name</span><span class="o">=</span><span class="n">constant_pool</span>
<span class="n">idx</span><span class="o">=</span><span class="mo">01</span> <span class="n">addr</span><span class="o">=</span><span class="mh">0x0000066e</span> <span class="n">off</span><span class="o">=</span><span class="mh">0x0000066e</span> <span class="n">sz</span><span class="o">=</span><span class="mi">10</span> <span class="n">vsz</span><span class="o">=</span><span class="mi">0</span> <span class="n">perm</span><span class="o">=----</span> <span class="n">name</span><span class="o">=</span><span class="n">fields</span>
<span class="n">idx</span><span class="o">=</span><span class="mo">02</span> <span class="n">addr</span><span class="o">=</span><span class="mh">0x00000678</span> <span class="n">off</span><span class="o">=</span><span class="mh">0x00000678</span> <span class="n">sz</span><span class="o">=</span><span class="mi">862</span> <span class="n">vsz</span><span class="o">=</span><span class="mi">0</span> <span class="n">perm</span><span class="o">=----</span> <span class="n">name</span><span class="o">=</span><span class="n">methods</span>
<span class="n">idx</span><span class="o">=</span><span class="mo">03</span> <span class="n">addr</span><span class="o">=</span><span class="mh">0x00000682</span> <span class="n">off</span><span class="o">=</span><span class="mh">0x00000682</span> <span class="n">sz</span><span class="o">=</span><span class="mi">69</span> <span class="n">vsz</span><span class="o">=</span><span class="mi">0</span> <span class="n">perm</span><span class="o">=----</span> <span class="n">name</span><span class="o">=</span><span class="n">attrs</span><span class="p">.</span><span class="n">_init_</span>
<span class="n">idx</span><span class="o">=</span><span class="mo">04</span> <span class="n">addr</span><span class="o">=</span><span class="mh">0x000006bf</span> <span class="n">off</span><span class="o">=</span><span class="mh">0x000006bf</span> <span class="n">sz</span><span class="o">=</span><span class="mi">369</span> <span class="n">vsz</span><span class="o">=</span><span class="mi">0</span> <span class="n">perm</span><span class="o">=----</span> <span class="n">name</span><span class="o">=</span><span class="n">attrs</span><span class="p">.</span><span class="n">init</span>
<span class="n">idx</span><span class="o">=</span><span class="mo">05</span> <span class="n">addr</span><span class="o">=</span><span class="mh">0x00000828</span> <span class="n">off</span><span class="o">=</span><span class="mh">0x00000828</span> <span class="n">sz</span><span class="o">=</span><span class="mi">303</span> <span class="n">vsz</span><span class="o">=</span><span class="mi">0</span> <span class="n">perm</span><span class="o">=----</span> <span class="n">name</span><span class="o">=</span><span class="n">attrs</span><span class="p">.</span><span class="n">createMe</span>
<span class="n">idx</span><span class="o">=</span><span class="mo">06</span> <span class="n">addr</span><span class="o">=</span><span class="mh">0x0000094f</span> <span class="n">off</span><span class="o">=</span><span class="mh">0x0000094f</span> <span class="n">sz</span><span class="o">=</span><span class="mi">50</span> <span class="n">vsz</span><span class="o">=</span><span class="mi">0</span> <span class="n">perm</span><span class="o">=----</span> <span class="n">name</span><span class="o">=</span><span class="n">attrs</span><span class="p">.</span><span class="n">getPath</span>
<span class="n">idx</span><span class="o">=</span><span class="mo">07</span> <span class="n">addr</span><span class="o">=</span><span class="mh">0x00000979</span> <span class="n">off</span><span class="o">=</span><span class="mh">0x00000979</span> <span class="n">sz</span><span class="o">=</span><span class="mi">65</span> <span class="n">vsz</span><span class="o">=</span><span class="mi">0</span> <span class="n">perm</span><span class="o">=----</span> <span class="n">name</span><span class="o">=</span><span class="n">attrs</span><span class="p">.</span><span class="n">main</span>
<span class="n">idx</span><span class="o">=</span><span class="mi">08</span> <span class="n">addr</span><span class="o">=</span><span class="mh">0x000009b2</span> <span class="n">off</span><span class="o">=</span><span class="mh">0x000009b2</span> <span class="n">sz</span><span class="o">=</span><span class="mi">52</span> <span class="n">vsz</span><span class="o">=</span><span class="mi">0</span> <span class="n">perm</span><span class="o">=----</span> <span class="n">name</span><span class="o">=</span><span class="n">attrs</span><span class="p">.</span><span class="n">_clinit_</span>
<span class="n">idx</span><span class="o">=</span><span class="mi">09</span> <span class="n">addr</span><span class="o">=</span><span class="mh">0x000009d6</span> <span class="n">off</span><span class="o">=</span><span class="mh">0x000009d6</span> <span class="n">sz</span><span class="o">=</span><span class="mi">10</span> <span class="n">vsz</span><span class="o">=</span><span class="mi">0</span> <span class="n">perm</span><span class="o">=----</span> <span class="n">name</span><span class="o">=</span><span class="n">attributes</span>

<span class="mi">10</span> <span class="n">sections</span>
</pre></div>


<h2>5. Yanking Around Files</h2>
<p>Some other neat features that were added to Radare as part of this project improved the file yanking capability.  Yanking, as the name implies, is the copying and pasting of bytes into a buffer or file.  This feature is enhanced by allowing files to yanked into or out of an archive.  For example, if an analyst is reversing a Java application, they might want to inject a class file into the archive or extract only a single file from the archive.  This means if a firmware images could also be manipulated in this manner, if the archive is implemented in the IO layer of Radare.</p>
<p>Examples below will demonstrate how to yank a file from an archive, print the disassembly, and then write the file to disk.  Another example will show how to yank code out of a Java function, and then paste this code into a file for further analysis.  A third example will show a file being added from the file system into the ZIP archive.</p>
<p>Before the demonstration, here is a quick summary of the commands used here:</p>
<ol>
<li><strong>yfa:</strong> yank the entire file into the yank buffer using the IO layer to retrieve the file</li>
<li><strong>yx:</strong> print the yanked buffer as hex shown with the offset, the hexlified-bytes, and then the bytes themselves.</li>
<li><strong>yy:</strong> paste the yank buffer to the given address or current location</li>
<li><strong>y:</strong> print a summary of the yank buffer</li>
<li><strong>wen:</strong> extend the buffer by N-bytes null bytes from the current position</li>
<li><strong>!ls -al:</strong> perform the shell command "<strong>ls -al</strong>"</li>
<li><strong>? x- y:</strong> perform the binary operation x-y and show the result</li>
<li><strong>wt <em>[filename]</em>:</strong> write the buffer to disk</li>
<li><strong>o- <em>[number]</em>:</strong> close the file</li>
<li><strong>o+ <em>[filename]</em>:</strong> open a file for write mode</li>
<li><strong>ib:</strong> reload the bin from the buffer</li>
</ol>
<h3>Yank the File from Buffer and Write to Disk</h3>
<p>Below is an example of opening Radare with a small (512 bytes) memory backed buffer.  This buffer will need to be resized with "<strong>wen</strong>" to accommodate the data from the target file, <strong>anypkg/Attacker.class</strong>, in the archive.  Then "<strong>yy</strong>' is used to paste the bytes,  and the "<strong>ib</strong>" (info buffer) command is used to reload the buffer to detect type of content and load it as a Java class file.  This class file will then be saved to disk with "<strong>wt</strong>".</p>
<div class="highlight"><pre><span class="err">$</span> <span class="nx">r2</span> <span class="nb">zip</span><span class="p">:</span><span class="c1">//example.zip</span>
<span class="n">Files</span> <span class="k">in</span> <span class="nb">archive</span>
<span class="mi">0</span> <span class="nx">anypkg</span><span class="p">/</span><span class="nx">Attacker.class</span>
<span class="mi">1</span> <span class="nx">anypkg</span><span class="p">/</span><span class="nx">BlyahaMuha.class</span>

<span class="err">$</span> <span class="nx">r2</span> <span class="o">-</span>
<span class="err">[</span><span class="mh">0x00000000</span><span class="cp">]</span>&gt; yfa zip://example.zip::0; yx
- offset -   0 1  2 3  4 5  6 7  8 9  A B  C D  E F  0123456789ABCDEF
0x00000000  cafe babe 0000 0033 0090 0a00 2700 570a  .......3....&#39;.W.
0x00000010  0027 0058 0800 590a 0026 005a 0900 2600  .&#39;.X..Y..<span class="err">&amp;</span>.Z..<span class="err">&amp;</span>.
0x00000020  5b07 005c 0a00 0600 5703 0001 86a0 0a00  <span class="cp">[</span><span class="nx">..</span><span class="o">\</span><span class="nx">....W.......</span>
<span class="mh">0x00000030</span>  <span class="mi">0600</span> <span class="mi">5</span><span class="nx">d07</span> <span class="mi">005</span><span class="nx">e</span> <span class="mi">0500</span> <span class="mi">0000</span> <span class="mi">0000</span> <span class="mi">0000</span> <span class="mi">640</span><span class="nx">a</span>  <span class="nx">..</span><span class="cp">]</span>..^........d.
0x00000040  005f 0060 0700 610a 001b 0062 0a00 1800  ._.`..a....b....
0x00000050  6307 0046 0a00 2600 6407 0065 0800 6608  c..F..<span class="err">&amp;</span>.d..e..f.
0x00000060  0067 0800 680a 0020 0069 0700 6a07 0039  .g..h.. .i..j..9
0x00000070  0a00 1800 6b07 006c 0a00 6d00 6e07 006f  ....k..l..m.n..o
0x00000080  0a00 1d00 5708 0070 0700 7108 0072 0700  ....W..p..q..r..
0x00000090  730a 0022 0074 0a00 1d00 750a 001d 0076  s..&quot;.t....u....v
0x000000a0  0700 7707 0078 0100 0a5f 6c61 7374 5061  ..w..x..._lastPa
0x000000b0  7261 6d01 0012 4c6a 6176 612f 6c61 6e67  ram...Ljava/lang
0x000000c0  2f53 7472 696e 673b 0100 063c 696e 6974  /String;...<span class="nt">&lt;init</span>
<span class="err">&lt;</span><span class="na">snip</span><span class="nt">&gt;</span>

<span class="cp">[</span><span class="mh">0x00000000</span><span class="cp">]</span>&gt; if
file    malloc://512
fd      2946784
size    0x200
mode    rw-
block   0x100
uri     malloc://512

<span class="cp">[</span><span class="mh">0x00000000</span><span class="cp">]</span>&gt; y
0xffffffffffffffff 2528 cafebabe0000003300900a002700570a002700580800590a0026005a090026005b<span class="nt">&lt;truncated&gt;</span>

<span class="cp">[</span><span class="mh">0x00000000</span><span class="cp">]</span>&gt; ? 2528-0x200
2016 0x7e0 03740 1.0K 0000:07e0 2016 11100000 2016.0 0.000000
<span class="cp">[</span><span class="mh">0x00000000</span><span class="cp">]</span>&gt; wen 2016; yy; ib
<span class="cp">[</span><span class="mh">0x000009c0</span><span class="cp">]</span>&gt; if
file    malloc://512
type    JAVA CLASS
pic     false
has_va  false
root    classprint the disassembly
class   0x3300 0x0000
lang    java
arch    java
bits    32
machine Java VM
os      any
subsys  any
endian  little
strip   false
static  false
linenum true
lsyms   true
relocs  false
rpath   NONE
type    JAVA CLASS
os      any
arch    Java VM
bits    32
endian  little
file    malloc://512
fd      2791744
size    0x9e0
mode    rw-
block   0x100
uri     malloc://512

<span class="cp">[</span><span class="mh">0x000009c0</span><span class="cp">]</span>&gt; s sym.anypkg_Attacker.createMe; af; pdf
/ (fcn) sym.anypkg_Attacker.createMe 105
|          0x00000836    bb001d       new java/io/ByteArrayOutputStream 
|          0x00000839    59           dup
|          0x0000083a    b7001e       invokespecial java/io/ByteArrayOutputStream/<span class="nt">&lt;init&gt;</span>()V
|             0x00000000()
|          0x0000083d    4c           astore_1
|          0x0000083e    01           aconst_null
|          0x0000083f    4d           astore_2
|          0x00000840    130018       ldc_w java/lang/Classprint the disassembly
|          0x00000843    121f         ldc &quot;getReso@urceA@sStream&quot;
<span class="nt">&lt;snip&gt;</span>
<span class="cp">[</span><span class="mh">0x00000836</span><span class="cp">]</span>&gt; wt Attacker.class
<span class="cp">[</span><span class="mh">0x00000836</span><span class="cp">]</span>&gt; !ls -al
total 4
drwxrwxr-x 5 dso dso 4096 Apr  8 20:33 .
drwxrwxr-x 6 dso dso 4096 Nov 21 19:33 ..
-rw-r--r-- 1 dso dso  256 Apr  8 20:33 Attacker.class
-rw-r--r-- 1 dso dso 2104 Apr  8 11:43 example.zip
</pre></div>


<h3>Yank Some Code From the Archive and Paste to a File</h3>
<p>Below is an example of how to yank a method from a Java class file, and then paste it into a file for further analysis.  In this example, the <strong>Attacker.class</strong> will be opened from the JAR file, and analysis will be performed so that we can yank out the <em>createMe</em> method from this class.  Once the method is yanked, the class file will be closed and a new file <strong>createMe.method</strong> will be written to the disk.  Then this file will be opened, and the architecture will be set to java.  Afterwards, the assembly will be printed.  This technique can be used to save off interesting code, but note, the CP object reference resolutions will not be extracted with the code.</p>
<div class="highlight"><pre><span class="err">$</span> <span class="n">r2</span> <span class="n">zip</span><span class="o">:</span><span class="c1">//example.zip//anypkg/Attacker.class</span>
<span class="p">[</span><span class="mh">0x00000690</span><span class="p">]</span><span class="o">&gt;</span> <span class="n">af</span><span class="p">;</span> <span class="n">s</span> <span class="n">sym</span><span class="p">.</span><span class="n">anypkg_Attacker</span><span class="p">.</span><span class="n">createMe</span><span class="p">;</span> <span class="n">pdf</span>
<span class="o">/</span> <span class="p">(</span><span class="n">fcn</span><span class="p">)</span> <span class="n">sym</span><span class="p">.</span><span class="n">anypkg_Attacker</span><span class="p">.</span><span class="n">createMe</span> <span class="mi">105</span>
<span class="o">|</span>          <span class="mh">0x00000836</span>    <span class="n">bb001d</span>       <span class="n">new</span> <span class="n">java</span><span class="o">/</span><span class="n">io</span><span class="o">/</span><span class="n">ByteArrayOutputStream</span> 
<span class="o">|</span>          <span class="mh">0x00000839</span>    <span class="mi">59</span>           <span class="n">dup</span>
<span class="o">|</span>          <span class="mh">0x0000083a</span>    <span class="n">b7001e</span>       <span class="n">invokespecial</span> <span class="n">java</span><span class="o">/</span><span class="n">io</span><span class="o">/</span><span class="n">ByteArrayOutputStream</span><span class="o">/&lt;</span><span class="n">init</span><span class="o">&gt;</span><span class="p">()</span><span class="n">V</span>
<span class="o">|</span>             <span class="mh">0x00000000</span><span class="p">()</span> <span class="p">;</span> <span class="n">section</span><span class="p">.</span><span class="n">constant_pool</span>
<span class="o">|</span>          <span class="mh">0x0000083d</span>    <span class="mi">4</span><span class="n">c</span>           <span class="n">astore_1</span>
<span class="o">|</span>          <span class="mh">0x0000083e</span>    <span class="mo">01</span>           <span class="n">aconst_null</span>
<span class="o">|</span>          <span class="mh">0x0000083f</span>    <span class="mi">4</span><span class="n">d</span>           <span class="n">astore_2</span>
<span class="o">|</span>          <span class="mh">0x00000840</span>    <span class="mi">130018</span>       <span class="n">ldc_w</span> <span class="n">java</span><span class="o">/</span><span class="n">lang</span><span class="o">/</span><span class="kt">Class</span>
<span class="o">|</span>          <span class="mh">0x00000843</span>    <span class="mf">121f</span>         <span class="n">ldc</span> <span class="s">&quot;getReso@urceA@sStream&quot;</span>
<span class="o">|</span>          <span class="mh">0x00000845</span>    <span class="mi">1215</span>         <span class="n">ldc</span> <span class="s">&quot;@&quot;</span>
<span class="o">|</span>          <span class="mh">0x00000847</span>    <span class="mi">1216</span>         <span class="n">ldc</span> <span class="s">&quot;&quot;</span>
<span class="o">|</span>          <span class="mh">0x00000849</span>    <span class="n">b60017</span>       <span class="n">invokevirtual</span> <span class="n">java</span><span class="o">/</span><span class="n">lang</span><span class="o">/</span><span class="n">String</span><span class="o">/</span><span class="n">replace</span><span class="p">(</span><span class="n">Ljava</span><span class="o">/</span><span class="n">lang</span><span class="o">/</span><span class="n">CharSequence</span><span class="p">;</span><span class="n">Ljava</span><span class="o">/</span><span class="n">lang</span><span class="o">/</span><span class="n">CharSequence</span><span class="p">;)</span><span class="n">Ljava</span><span class="o">/</span><span class="n">lang</span><span class="o">/</span><span class="n">String</span><span class="p">;</span>
<span class="o">|</span>             <span class="mh">0x00000000</span><span class="p">(</span><span class="mh">0x0</span><span class="p">,</span> <span class="mh">0x0</span><span class="p">,</span> <span class="mh">0x0</span><span class="p">,</span> <span class="mh">0x0</span><span class="p">,</span> <span class="mh">0x0</span><span class="p">,</span> <span class="mh">0x0</span><span class="p">,</span> <span class="mh">0x0</span><span class="p">)</span> <span class="p">;</span> <span class="n">section</span><span class="p">.</span><span class="n">constant_pool</span>
<span class="o">|</span>          <span class="mh">0x0000084c</span>    <span class="mo">04</span>           <span class="n">iconst_1</span>
<span class="o">|</span>          <span class="mh">0x0000084d</span>    <span class="n">bd0018</span>       <span class="n">anewarray</span> <span class="n">java</span><span class="o">/</span><span class="n">lang</span><span class="o">/</span><span class="kt">Class</span> 
<span class="o">|</span>          <span class="mh">0x00000850</span>    <span class="mi">59</span>           <span class="n">dup</span>
<span class="o">|</span>          <span class="mh">0x00000851</span>    <span class="mo">03</span>           <span class="n">iconst_0</span>
<span class="o">|</span>          <span class="mh">0x00000852</span>    <span class="mi">130020</span>       <span class="n">ldc_w</span> <span class="n">java</span><span class="o">/</span><span class="n">lang</span><span class="o">/</span><span class="n">String</span>
<span class="o">|</span>          <span class="mh">0x00000855</span>    <span class="mi">53</span>           <span class="n">aastore</span>
<span class="o">|</span>          <span class="mh">0x00000856</span>    <span class="n">b6001a</span>       <span class="n">invokevirtual</span> <span class="n">java</span><span class="o">/</span><span class="n">lang</span><span class="o">/</span><span class="kt">Class</span><span class="o">/</span><span class="n">getMethod</span><span class="p">(</span><span class="n">Ljava</span><span class="o">/</span><span class="n">lang</span><span class="o">/</span><span class="n">String</span><span class="p">;[</span><span class="n">Ljava</span><span class="o">/</span><span class="n">lang</span><span class="o">/</span><span class="kt">Class</span><span class="p">;)</span><span class="n">Ljava</span><span class="o">/</span><span class="n">lang</span><span class="o">/</span><span class="n">reflect</span><span class="o">/</span><span class="n">Method</span><span class="p">;</span>
<span class="o">|</span>             <span class="mh">0x00000000</span><span class="p">(</span><span class="mh">0x0</span><span class="p">,</span> <span class="mh">0x0</span><span class="p">,</span> <span class="mh">0x0</span><span class="p">,</span> <span class="mh">0x0</span><span class="p">)</span> <span class="p">;</span> <span class="n">section</span><span class="p">.</span><span class="n">constant_pool</span>
<span class="o">|</span>          <span class="mh">0x00000859</span>    <span class="mi">2</span><span class="n">a</span>           <span class="n">aload_0</span>
<span class="o">|</span>          <span class="mh">0x0000085a</span>    <span class="n">b6000f</span>       <span class="n">invokevirtual</span> <span class="n">java</span><span class="o">/</span><span class="n">lang</span><span class="o">/</span><span class="n">Object</span><span class="o">/</span><span class="n">getClass</span><span class="p">()</span><span class="n">Ljava</span><span class="o">/</span><span class="n">lang</span><span class="o">/</span><span class="kt">Class</span><span class="p">;</span>
<span class="o">|</span>             <span class="mh">0x00000000</span><span class="p">(</span><span class="mh">0x0</span><span class="p">)</span> <span class="p">;</span> <span class="n">section</span><span class="p">.</span><span class="n">constant_pool</span>
<span class="o">|</span>          <span class="mh">0x0000085d</span>    <span class="mo">04</span>           <span class="n">iconst_1</span>
<span class="o">|</span>          <span class="mh">0x0000085e</span>    <span class="n">bd001b</span>       <span class="n">anewarray</span> <span class="n">java</span><span class="o">/</span><span class="n">lang</span><span class="o">/</span><span class="n">Object</span> 
<span class="o">|</span>          <span class="mh">0x00000861</span>    <span class="mi">59</span>           <span class="n">dup</span>
<span class="o">|</span>          <span class="mh">0x00000862</span>    <span class="mo">03</span>           <span class="n">iconst_0</span>
<span class="o">|</span>          <span class="mh">0x00000863</span>    <span class="mi">1221</span>         <span class="n">ldc</span> <span class="s">&quot;/x/Make@Som@eFun.cla@ss&quot;</span>
<span class="o">|</span>          <span class="mh">0x00000865</span>    <span class="mi">1215</span>         <span class="n">ldc</span> <span class="s">&quot;@&quot;</span>
<span class="o">|</span>          <span class="mh">0x00000867</span>    <span class="mi">1216</span>         <span class="n">ldc</span> <span class="s">&quot;&quot;</span>
<span class="o">|</span>          <span class="mh">0x00000869</span>    <span class="n">b60017</span>       <span class="n">invokevirtual</span> <span class="n">java</span><span class="o">/</span><span class="n">lang</span><span class="o">/</span><span class="n">String</span><span class="o">/</span><span class="n">replace</span><span class="p">(</span><span class="n">Ljava</span><span class="o">/</span><span class="n">lang</span><span class="o">/</span><span class="n">CharSequence</span><span class="p">;</span><span class="n">Ljava</span><span class="o">/</span><span class="n">lang</span><span class="o">/</span><span class="n">CharSequence</span><span class="p">;)</span><span class="n">Ljava</span><span class="o">/</span><span class="n">lang</span><span class="o">/</span><span class="n">String</span><span class="p">;</span>
<span class="o">|</span>             <span class="mh">0x00000000</span><span class="p">(</span><span class="mh">0x0</span><span class="p">,</span> <span class="mh">0x0</span><span class="p">,</span> <span class="mh">0x0</span><span class="p">,</span> <span class="mh">0x0</span><span class="p">,</span> <span class="mh">0x0</span><span class="p">)</span> <span class="p">;</span> <span class="n">section</span><span class="p">.</span><span class="n">constant_pool</span>
<span class="o">|</span>          <span class="mh">0x0000086c</span>    <span class="mi">53</span>           <span class="n">aastore</span>
<span class="o">|</span>          <span class="mh">0x0000086d</span>    <span class="n">b6001c</span>       <span class="n">invokevirtual</span> <span class="n">java</span><span class="o">/</span><span class="n">lang</span><span class="o">/</span><span class="n">reflect</span><span class="o">/</span><span class="n">Method</span><span class="o">/</span><span class="n">invoke</span><span class="p">(</span><span class="n">Ljava</span><span class="o">/</span><span class="n">lang</span><span class="o">/</span><span class="n">Object</span><span class="p">;[</span><span class="n">Ljava</span><span class="o">/</span><span class="n">lang</span><span class="o">/</span><span class="n">Object</span><span class="p">;)</span><span class="n">Ljava</span><span class="o">/</span><span class="n">lang</span><span class="o">/</span><span class="n">Object</span><span class="p">;</span>
<span class="o">|</span>             <span class="mh">0x00000000</span><span class="p">(</span><span class="mh">0x0</span><span class="p">)</span> <span class="p">;</span> <span class="n">section</span><span class="p">.</span><span class="n">constant_pool</span>
<span class="o">|</span>          <span class="mh">0x00000870</span>    <span class="n">c00022</span>       <span class="n">checkcast</span> <span class="n">java</span><span class="o">/</span><span class="n">io</span><span class="o">/</span><span class="n">InputStream</span> 
<span class="o">|</span>          <span class="mh">0x00000873</span>    <span class="mi">4</span><span class="n">d</span>           <span class="n">astore_2</span>
<span class="o">|</span>      <span class="p">,</span><span class="o">=&lt;</span> <span class="mh">0x00000874</span>    <span class="n">a70004</span>       <span class="k">goto</span> <span class="mh">0x0878</span> <span class="p">;</span> <span class="p">(</span><span class="n">sym</span><span class="p">.</span><span class="n">anypkg_Attacker</span><span class="p">.</span><span class="n">createMe</span><span class="p">)</span>
<span class="o">|</span>      <span class="o">|</span>   <span class="mh">0x00000877</span>    <span class="mi">4</span><span class="n">e</span>           <span class="n">astore_3</span>
<span class="o">|</span>      <span class="err">`</span><span class="o">-&gt;</span> <span class="mh">0x00000878</span>    <span class="mi">110800</span>       <span class="n">sipush</span> <span class="mi">2048</span>
<span class="o">|</span>          <span class="mh">0x0000087b</span>    <span class="n">bc08</span>         <span class="n">newarray</span> <span class="mi">8</span>
<span class="o">|</span>          <span class="mh">0x0000087d</span>    <span class="mi">3</span><span class="n">a04</span>         <span class="n">astore</span> <span class="mi">4</span>
<span class="o">|</span>          <span class="mh">0x0000087f</span>    <span class="mi">2</span><span class="n">c</span>           <span class="n">aload_2</span>
<span class="o">|</span>          <span class="mh">0x00000880</span>    <span class="mi">1904</span>         <span class="n">aload</span> <span class="mi">4</span>
<span class="o">|</span>          <span class="mh">0x00000882</span>    <span class="mo">03</span>           <span class="n">iconst_0</span>
<span class="o">|</span>          <span class="mh">0x00000883</span>    <span class="mi">1904</span>         <span class="n">aload</span> <span class="mi">4</span>
<span class="o">|</span>          <span class="mh">0x00000885</span>    <span class="n">be</span>           <span class="n">arraylength</span>
<span class="o">|</span>          <span class="mh">0x00000886</span>    <span class="n">b60023</span>       <span class="n">invokevirtual</span> <span class="n">java</span><span class="o">/</span><span class="n">io</span><span class="o">/</span><span class="n">InputStream</span><span class="o">/</span><span class="n">read</span><span class="p">([</span><span class="n">BII</span><span class="p">)</span><span class="n">I</span>
<span class="o">|</span>             <span class="mh">0x00000000</span><span class="p">(</span><span class="mh">0x0</span><span class="p">,</span> <span class="mh">0x0</span><span class="p">,</span> <span class="mh">0x0</span><span class="p">,</span> <span class="mh">0x0</span><span class="p">,</span> <span class="mh">0x0</span><span class="p">,</span> <span class="mh">0x0</span><span class="p">,</span> <span class="mh">0x0</span><span class="p">,</span> <span class="mh">0x0</span><span class="p">)</span> <span class="p">;</span> <span class="n">section</span><span class="p">.</span><span class="n">constant_pool</span>
<span class="o">|</span>          <span class="mh">0x00000889</span>    <span class="mi">59</span>           <span class="n">dup</span>
<span class="o">|</span>          <span class="mh">0x0000088a</span>    <span class="mi">3</span><span class="n">e</span>           <span class="n">istore_3</span>
<span class="o">|</span>          <span class="mh">0x0000088b</span>    <span class="mo">02</span>           <span class="n">iconst_m1</span>
<span class="o">|</span>     <span class="p">,</span><span class="o">==&lt;</span> <span class="mh">0x0000088c</span>    <span class="mf">9f</span><span class="mo">000</span><span class="n">e</span>       <span class="n">if_icmpeq</span> <span class="mh">0x089a</span>
<span class="o">|</span>     <span class="o">|</span>    <span class="mh">0x0000088f</span>    <span class="mi">2</span><span class="n">b</span>           <span class="n">aload_1</span>
<span class="o">|</span>     <span class="o">|</span>    <span class="mh">0x00000890</span>    <span class="mi">1904</span>         <span class="n">aload</span> <span class="mi">4</span>
<span class="o">|</span>     <span class="o">|</span>    <span class="mh">0x00000892</span>    <span class="mo">03</span>           <span class="n">iconst_0</span>
<span class="o">|</span>     <span class="o">|</span>    <span class="mh">0x00000893</span>    <span class="mi">1</span><span class="n">d</span>           <span class="n">iload_3</span>
<span class="o">|</span>     <span class="o">|</span>    <span class="mh">0x00000894</span>    <span class="n">b60024</span>       <span class="n">invokevirtual</span> <span class="n">java</span><span class="o">/</span><span class="n">io</span><span class="o">/</span><span class="n">ByteArrayOutputStream</span><span class="o">/</span><span class="n">write</span><span class="p">([</span><span class="n">BII</span><span class="p">)</span><span class="n">V</span>
<span class="o">|</span>     <span class="o">|</span>       <span class="mh">0x00000000</span><span class="p">(</span><span class="mh">0x0</span><span class="p">,</span> <span class="mh">0x0</span><span class="p">,</span> <span class="mh">0x0</span><span class="p">,</span> <span class="mh">0x0</span><span class="p">,</span> <span class="mh">0x0</span><span class="p">,</span> <span class="mh">0x0</span><span class="p">)</span> <span class="p">;</span> <span class="n">section</span><span class="p">.</span><span class="n">constant_pool</span>
<span class="o">|</span>     <span class="o">|</span>    <span class="mh">0x00000897</span>    <span class="n">a7ffe8</span>       <span class="k">goto</span> <span class="mh">0x087f</span> <span class="p">;</span> <span class="p">(</span><span class="n">sym</span><span class="p">.</span><span class="n">anypkg_Attacker</span><span class="p">.</span><span class="n">createMe</span><span class="p">)</span>
<span class="o">|</span>     <span class="err">`</span><span class="o">--&gt;</span> <span class="mh">0x0000089a</span>    <span class="mi">2</span><span class="n">b</span>           <span class="n">aload_1</span>
<span class="o">|</span>          <span class="mh">0x0000089b</span>    <span class="n">b60025</span>       <span class="n">invokevirtual</span> <span class="n">java</span><span class="o">/</span><span class="n">io</span><span class="o">/</span><span class="n">ByteArrayOutputStream</span><span class="o">/</span><span class="n">toByteArray</span><span class="p">()[</span><span class="n">B</span>
<span class="o">|</span>             <span class="mh">0x00000000</span><span class="p">(</span><span class="mh">0x0</span><span class="p">)</span> <span class="p">;</span> <span class="n">section</span><span class="p">.</span><span class="n">constant_pool</span>
<span class="err">\</span>          <span class="mh">0x0000089e</span>    <span class="n">b0</span>           <span class="n">areturn</span>

<span class="p">[</span><span class="mh">0x00000836</span><span class="p">]</span><span class="o">&gt;</span> <span class="n">y</span> <span class="mi">105</span>
<span class="p">[</span><span class="mh">0x00000836</span><span class="p">]</span><span class="o">&gt;</span> <span class="n">o</span>
<span class="o">-</span> <span class="mi">51309</span> <span class="n">zip</span><span class="o">:</span><span class="c1">//example.zip//anypkg/Attacker.class @ 0x0 ; r</span>
<span class="p">[</span><span class="mh">0x00000836</span><span class="p">]</span><span class="o">&gt;</span> <span class="n">o</span><span class="o">-</span> <span class="mi">51309</span>
<span class="p">[</span><span class="mh">0x00000836</span><span class="p">]</span><span class="o">&gt;</span> <span class="n">o</span><span class="o">+</span> <span class="n">createMe</span><span class="p">.</span><span class="n">method</span>

<span class="p">[</span><span class="mh">0x00000836</span><span class="p">]</span><span class="o">&gt;</span> <span class="n">s</span> <span class="mi">0</span><span class="p">;</span> <span class="p">;</span> <span class="n">yy</span><span class="p">;</span> <span class="o">!</span><span class="n">ls</span> <span class="o">-</span><span class="n">al</span>
<span class="n">total</span> <span class="mi">5</span>
<span class="n">drwxrwxr</span><span class="o">-</span><span class="n">x</span> <span class="mi">5</span> <span class="n">dso</span> <span class="n">dso</span> <span class="mi">4096</span> <span class="n">Apr</span>  <span class="mi">8</span> <span class="mi">20</span><span class="o">:</span><span class="mi">41</span> <span class="p">.</span>
<span class="n">drwxrwxr</span><span class="o">-</span><span class="n">x</span> <span class="mi">6</span> <span class="n">dso</span> <span class="n">dso</span> <span class="mi">4096</span> <span class="n">Nov</span> <span class="mi">21</span> <span class="mi">19</span><span class="o">:</span><span class="mi">33</span> <span class="p">..</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--</span> <span class="mi">1</span> <span class="n">dso</span> <span class="n">dso</span>  <span class="mi">256</span> <span class="n">Apr</span>  <span class="mi">8</span> <span class="mi">20</span><span class="o">:</span><span class="mi">33</span> <span class="n">Attacker</span><span class="p">.</span><span class="n">class</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--</span> <span class="mi">1</span> <span class="n">dso</span> <span class="n">dso</span>  <span class="mi">105</span> <span class="n">Apr</span>  <span class="mi">8</span> <span class="mi">20</span><span class="o">:</span><span class="mi">41</span> <span class="n">createMe</span><span class="p">.</span><span class="n">method</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--</span> <span class="mi">1</span> <span class="n">dso</span> <span class="n">dso</span> <span class="mi">2104</span> <span class="n">Apr</span>  <span class="mi">8</span> <span class="mi">11</span><span class="o">:</span><span class="mi">43</span> <span class="n">example</span><span class="p">.</span><span class="n">zip</span>
</pre></div>


<p>Now the code will be loaded from the createMe.method and the code will be disassembled with "<strong>pdn</strong>" (print disassembly of N bytes).  Next, the architecture will be switched to Java and "<strong>pdn</strong>" will be used again.  Note the pdn is used to disassemble up to the number of bytes passed to it.  In this case, 105 bytes are all that are in createMe.method, so only 105 bytes should be disassembled.</p>
<p>When <strong>pdn</strong> is first executed it is going to print <em>105</em> instructions from data interpretted as x86 machine code.</p>
<div class="highlight"><pre><span class="err">$</span> <span class="nx">r2</span> <span class="nx">createMe.method</span> 
<span class="err">[</span><span class="mh">0x00000000</span><span class="cp">]</span>&gt; pdn 105
0x00000000   bb001d59b7 mov ebx, 0xb7591d00
0x00000005         001e add <span class="cp">[</span><span class="nx">rsi</span><span class="cp">]</span>, bl
0x00000007     4c014d13 add <span class="cp">[</span><span class="nx">rbp</span><span class="o">+</span><span class="mh">0x13</span><span class="cp">]</span>, r9
0x0000000b         0018 add <span class="cp">[</span><span class="nx">rax</span><span class="cp">]</span>, bl
0x0000000d         121f adc bl, <span class="cp">[</span><span class="nx">rdi</span><span class="cp">]</span>
0x0000000f 12151216b600 adc dl, <span class="cp">[</span><span class="nx">rip</span><span class="o">+</span><span class="mh">0xb61612</span><span class="cp">]</span>
0x00000015               17  <span class="nt">&lt;invalid&gt;</span>
0x00000016         04bd add al, 0xbd
0x00000018         0018 add <span class="cp">[</span><span class="nx">rax</span><span class="cp">]</span>, bl
0x0000001a           59 pop rcx
0x0000001b         0313 add edx, <span class="cp">[</span><span class="nx">rbx</span><span class="cp">]</span>
0x0000001d         0020 add <span class="cp">[</span><span class="nx">rax</span><span class="cp">]</span>, ah
<span class="nt">&lt;snip&gt;</span>
0x00000061       a7ffe8 goto 0x0049
0x00000064           2b aload_1
0x00000065       b60025 invokevirtual (37) INVALID CP_OBJ
0x00000068           b0 areturn
<span class="cp">[</span><span class="mh">0x00000000</span><span class="cp">]</span>&gt; 
</pre></div>


<p>After the architecture is switched to Java with <strong>e asm.arch=java</strong>, <strong>pdn</strong> prints <em>105</em> instructions disasembled as JVM bytecode.</p>
<div class="highlight"><pre><span class="cp">[</span><span class="mh">0x00000000</span><span class="cp">]</span>&gt; e asm.arch=java; pdn 105
0x00000000       bb001d new (29) INVALID CP_OBJ
0x00000003           59 dup
0x00000004       b7001e invokespecial (30) INVALID CP_OBJ
0x00000007           4c astore_1
0x00000008           01 aconst_null
0x00000009           4d astore_2
<span class="nt">&lt;snip&gt;</span>
0x00000055           02 iconst_m1
0x00000056       9f000e if_icmpeq 0x0064
0x00000059           2b aload_1
0x0000005a         1904 aload 4
0x0000005c           03 iconst_0
0x0000005d           1d iload_3
0x0000005e       b60024 invokevirtual (36) INVALID CP_OBJ
0x00000061       a7ffe8 goto 0x0049
0x00000064           2b aload_1
0x00000065       b60025 invokevirtual (37) INVALID CP_OBJ
0x00000068           b0 areturn
<span class="cp">[</span><span class="mh">0x00000000</span><span class="cp">]</span>&gt;
</pre></div>


<h3>Yank Some Code into the Archive to a File</h3>
<p>Below is an example of how to yank a data from a file on disk and then written into a ZIP archive.    In the case of Java, this is a great way to inject class files into an archive (topic of future discussion).  In this case, the sb.class is going to be added to the example.zip archive without having to use the zip command.  Once added to the class, "<strong>ib</strong>" will be executed to load class file.  Then the radare session is quit, and the file is reloaded from the archive.</p>
<div class="highlight"><pre><span class="err">$</span> <span class="nx">r2</span> <span class="nb">zip</span><span class="p">:</span><span class="c1">//example.zip</span>

<span class="n">Files</span> <span class="k">in</span> <span class="nb">archive</span>
<span class="mi">0</span> <span class="nx">anypkg</span><span class="p">/</span><span class="nx">Attacker.class</span>
<span class="mi">1</span> <span class="nx">anypkg</span><span class="p">/</span><span class="nx">BlyahaMuha.class</span>

<span class="err">$</span> <span class="nx">r2</span> <span class="nb">zip</span><span class="p">:</span><span class="c1">//example.zip//sb.class</span>
<span class="err">[</span><span class="mi">0000</span><span class="p">:</span><span class="mi">0000</span><span class="cp">]</span>&gt; yfa sb.class
<span class="cp">[</span><span class="mi">0000</span><span class="p">:</span><span class="mi">0000</span><span class="cp">]</span>&gt; yy
<span class="cp">[</span><span class="mi">0000</span><span class="p">:</span><span class="mi">0000</span><span class="cp">]</span>&gt; ib
<span class="cp">[</span><span class="mi">0000</span><span class="p">:</span><span class="mi">1225</span><span class="cp">]</span>&gt; if
file    sb.class
type    JAVA CLASS
pic     false
has_va  false
root    class
class   0x3200 0x0000
lang    java
arch    java
bits    32
machine Java VM
os      any
subsys  any
endian  little
strip   false
static  false
linenum true
lsyms   true
relocs  false
rpath   NONE
type    JAVA CLASS
os      any
arch    Java VM
bits    32
endian  little
file    sb.class
fd      5031
size    0x28e7
mode    r--
block   0x100
uri     zip://example.zip//sb.class

<span class="cp">[</span><span class="mi">0000</span><span class="p">:</span><span class="mi">1225</span><span class="cp">]</span>&gt; q

$ r2 zip://example.zip//sb.class
<span class="cp">[</span><span class="mh">0x0000108c</span><span class="cp">]</span>&gt; af;pdf
/ (fcn) sym.java_lang_Object._init_ 16
|          0x0000108c    2a           aload_0
|          0x0000108d    b7000a       invokespecial java/lang/Object/<span class="nt">&lt;init&gt;</span>()V
|             0x00000000(0x0) ; section.constant_pool
|          0x00001090    2a           aload_0
|          0x00001091    bb000c       new java/lang/StringBuilder 
|          0x00001094    59           dup
|          0x00001095    b7000e       invokespecial java/lang/StringBuilder/<span class="nt">&lt;init&gt;</span>()V
|             0x00000000(0x0) ; section.constant_pool
|          0x00001098    b5000f       putfield sb/thisSb Ljava/lang/StringBuilder;
\          0x0000109b    b1           return

<span class="cp">[</span><span class="mh">0x0000108c</span><span class="cp">]</span>&gt; if
file    sb.class
type    JAVA CLASS
pic     false
has_va  false
root    class
class   0x3200 0x0000
lang    java
arch    java
bits    32
machine Java VM
os      any
subsys  any
endian  little
strip   false
static  false
linenum true
lsyms   true
relocs  false
rpath   NONE
type    JAVA CLASS
os      any
arch    Java VM
bits    32
endian  little
file    sb.class
fd      53803
size    0x28e7
mode    r--
block   0x100
uri     zip://example.zip//sb.class
</pre></div>


<h2>6. Conclusions</h2>
<p>This concludes the initial post of the radare extensions for Java reverse engineering.  In the next few posts, there will be a more detailed discussion about how to perform in-depth Java reversing and analysis with Radare extensions for Java.</p>
<p>greetz: pancake, xvilka, zlul (resident fuzzer), jvoisin, maijin</p><script type= "text/javascript">
    if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
        var mathjaxscript = document.createElement('script');
        mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
        mathjaxscript.type = 'text/javascript';
        mathjaxscript.src = 'https:' == document.location.protocol
                ? 'https://c328740.ssl.cf1.rackcdn.com/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'
                : 'http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
        mathjaxscript[(window.opera ? "innerHTML" : "text")] =
            "MathJax.Hub.Config({" +
            "    config: ['MMLorHTML.js']," +
            "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
            "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
            "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
            "    displayAlign: 'center'," +
            "    displayIndent: '0em'," +
            "    showMathMenu: true," +
            "    tex2jax: { " +
            "        inlineMath: [ ['$','$'] ], " +
            "        displayMath: [ ['$$','$$'] ]," +
            "        processEscapes: true," +
            "        preview: 'TeX'," +
            "    }, " +
            "    'HTML-CSS': { " +
            "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }" +
            "    } " +
            "}); ";
        (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
    }
</script>
</div>
                    &rarr;<a href="/posts/2014/04/radare-java-artifact-enumeration/">
                            Using Radare to Enumerate Artifacts in a Java Class File
                    </a>
		<div>
			<h2>Comments</h2>
		<div>
	</div>	
		<footer>
		  <p>Powered by <a href="http://getpelican.com/">Pelican</a>. Theme based on <a href="http://twitter.github.com/bootstrap/">Twitter Bootstrap</a>.</p>
		  <p>&copy; adam pridgen</p>
		</footer>
	  </div>

	</div>
</body>
</html>